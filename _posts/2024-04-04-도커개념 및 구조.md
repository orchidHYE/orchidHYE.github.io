---
layout: post
title: "[Docker] 도커 개념 및 구조"
date: 2024-04-04 22:16 +0900
categories:
  - Docker
tags: 
math: true
---

## 도커(Docker)란 무엇인가

- 도커(Docker)는 컨테이너 기반 **가상화** 플랫폼으로, 애플리케이션을 패키징하고 실행하는데 사용된다.
- 소프트웨어를 독립적인 단위인 컨테이너로 패키징하여 환경 간의 일관성을 유지하고, 애플리케이션을 더 쉽게 이동하고 배포할 수 있게 한다.


#### 가상화(Virtualization)란 무엇인가
- 가상화는 하드웨어 또는 소프트웨어를 사용하여 하나의 컴퓨터 시스템에서 여러 가상 환경을 만들어내는 기술이다.
- 가상화를 통해 물리적인 **하드웨어 자원을 효율적으로 활용**하고, 여러 개의 **독립적인 환경을 구축**하여 **서로 다른 운영 체제나 응용 프로그램을 실행**할 수 있다.

##### 하드웨어 가상화 (Hardware Virtualization)
- 하드웨어 수준에서 가상화 구현
- 가상 머신 모니터(Virtual Machine Monitor, VMM) 또는 하이퍼바이저(Hypervisor)를 사용하여 여러 개의 가상 머신을 호스트 시스템에서 실행
- 이를 통해 각 가상 머신은 독립적인 운영 체제 및 응용 프로그램을 실행할 수 이따.


##### 컨테이너 가상화 (Containerization)
- 응용 프로그램을 격리된 환경인 컨테이너에 패키징하는 기술
- 컨테이너는 호스트 시스템의 운영 체제 커널을 공유하며, 가상 머신에 비해 가볍고 빠르게 실행된다.
- Docker가 이에 해당한다.

<br/>

>##### 가상화의 장점
>- **자원의 효율적 사용**
>	- 가상화를 통해 하나의 물리적 서버에서 여러 개의 가상 시스템을 실행함으로써 자원을 더 효율적으로 활용
>- **격리**
>	- 각 가상 환경은 독립적으로 운영되므로, 한 가상 환경에서의 문제가 다른 가상 환경에 영향을 미치지 않음
>- **유연성**
>	- 가상 머신이나 컨테이너는 이동성이 뛰어나며, 쉽게 배포 및 복제 가능
>- **테스트 및 개발**
>	- 가상 환경에서 소프트웨어를 테스트하고 개발할 수 있으며, 환경을 쉽게 구성 변경 가능

<br/>


#### 컨테이너란 무엇인가
- 컨테이너는 애플리케이션을 실행하는데 필요한 모든 것(코드, 런타임, 시스템 도구, 시스템 라이브러리 등)을 패키징하여 격리된 환경을 만드는 기술
- 컨테이너는 가상 머신과 달리 호스트 시스템의 운영 체제 수준에서 격리되며, 리눅스의 `Cgroups`와 `네임스페이스` 기술을 활용하여 여러개의 독립적인 환경을 만들어낸다. 이를 통해 하나의 호스트 시스템에서 여러 컨테이너를 실행할 수 있어 자원을 효율적으로 활용할 수 있다.


>##### Cgroups (Control Groups)
>- Cgroups는 리눅스 커널 기능 중 하나로, 프로세스 그룹에 대한 자원 제한, 우선순위, 모니터링 등을 관리
>- 이를 통해 CPU, 메모리, 디스크 I/O, 네트워크 대역폭 등의 자원을 그룹 단위로 제어하고 할당할 수 있음
>- 예를 들어, 각각의 컨테이너에 CPU 사용량을 할당하거나 메모리 사용량을 제한하는 등의 제어 가능
><br/>
>##### 네임스페이스 (Namespace)
>- 네임스페이스는 리눅스 커널의 기능 중 하나로, 프로세스 및 리소스의 가상화를 제공
>- 각 네임스페이스는 특정 리소스의 가상 인스턴스를 제공하여, 호스트 시스템에서 격리된 환경 구성
>- 네임스페이스는 PID (Process ID), 네트워크, 마운트, 유저, 호스트 이름 등 여러 가지 리소스에 대한 가상화 지원
>- 이를 통해 각 컨테이너는 자신만의 프로세스 ID 공간, 네트워크 인터페이스, 파일 시스템 마운트 등을 갖게 되어 완전히 격리된 환경 형성
><br/>
>##### 요약 
>![7uy26J5.png](https://i.imgur.com/7uy26J5.png)
>**Cgroups는 자원관리를 위한 그룹화 및 제어를 제공하고 네임스페이스는 프로세스 및 리소스의 격리와 가상화를 담당하여 컨테이너의 독립성을 보장한다. 이 두 기술을 조합하여 리눅스 컨테이너가 가상화되고 격리된 환경을 구성할 수 있게 된다. 또, 애플리케이션 개발 및 배포시 발생할 수 있는 "작동하지 않음" 문제를 크게 줄여주며 애플리케이션의 이식성을 크게 향상시킨다.**

<br/>


## 도커(Docker) 기본 개념과 구조
## DockerEngine


![](https://i.imgur.com/0zvdUIT.png)
- 도커 엔진은 컨테이너를 생성하고 관리하는 기능을 제공하는 클라이언트-서버 형태의 애플리케이션이며 이는 세 가지 주요 구성 요소로 이루어져 있다.

##### 도커 데몬 (Docker Daemon)
- 도커의 핵심 엔진으로, 컨테이너의 생성, 관리, 실행 등을 담당하는 백그라운드 프로세스
- 호스트 OS에서 실행되며 클라이언트의 요청을 처리하고 컨테이너와 이미지의 상태 관리
- 호스트의 리소스를 관리하고 컨테이너의 라이프사이클을 관리하여 필요에 따라 컨테이너를 시작하거나 중지함

##### REST API
- 도커 데몬과 도커 클라이언트 간의 통신을 위한 인터페이스
- HTTP를 통해 도커 데몬에 요청을 보내고 응답을 받을 수 있도록 함
- REST API를 사용하면 프로그래밍 방식으로 도커를 제어하고, 자동화 및 통합에 유용하게 사용 가능

##### Docker CLI (Docker Command Line Interface)
- 사용자가 커맨드 라인을 통해 도커와 상호작용할 수 있도록 해주는 도구
- CLI를 통해 컨테이너 및 이미지의 생성, 실행, 관리, 모니터링 등 다양한 작업 수행 가능
- CLI 명령어를 사용하여 도커 데몬에 요청을 보내고, 결과를 받아와서 사용자에게 표시


## 동작방식

![](https://i.imgur.com/kgM6l8M.png)

#### 1. 이미지 다운로드 또는 빌드
- 도커 허브나 다른 이미지 저장소에서 이미지를 다운로드하거나, `Dokerfile`을 사용하여 새로운 이미지 빌드


#### 2. 컨테이너 생성
- 사용자가 도커 데몬에게 컨테이너 생성을 요청하면, 도커 데몬은 해당 이미지를 기반으로 새로운 컨테이너 인스턴스 생성


#### 3. 컨테이너 실행
- 컨테이너가 생성되면, 도커 데몬은 컨테이너 내부에서 정의된 애플리케이션을 실행
- 컨테이너는 격리된 환경에서 호스트 시스템과는 독립적으로 실행


#### 4. 컨테이너 관리
- 도커 엔진은 실행 중인 컨테이너를 모니터링하고 관리
- 사용자는 도커 CLI를 사용하여 컨테이너의 상태를 조회하고, 필요한 경우 중지, 재시작 또는 삭제할 수 있음


#### 5. 리소스 관리
- 도커 엔진은 리눅스의 핵심 기능임 `Cgroups`와 `네임스페이스`를 사용하여 컨테이너의 리소스 사용량을 제한하고 격리 유지
- 이를 통해 시스템의 안정성을 유지하고, 다른 컨테이너나 시스템 전체에 부정적인 영향을 최소


## Docker Architecture

![](https://i.imgur.com/Dst9ePG.png)

#### 도커 클라이언트 (Docker Client)
- 사용자가 도커를 사용하기 위해 커맨드 라인 혹은 GUI를 통해 상호작용하는 인터페이스
- 도커 클라이언트는 도커 데몬과 통신하여 컨테이너의 관리 및 작업 수행

#### 도커 레지스트리 (Docker Registry)
- 도커 이미지를 저장하고 공유하는 중앙 저장소
- 가장 널리 사용되는 도커 레지스트리 중 하나는 Docker Hub
- 사용자는 Docker Hub에서 공개 이미지를 사용하거나 자신의 이미지를 업로드하고 관리

#### 도커 이미지 (Image)
- 애플리케이션 실행에 필요한 모든 것을 포함하는 읽기 전용 템플릿
- 이미지는 도커 클라이언트 또는 빌드 도구를 사용하여 생성
- 이미지는 도커 레지스트리에 저장되거나 호스트 시스템에 로컬로 저장

#### 도커 컨테이너 (Container)
- 이미지의 인스턴스로, 격리된 환경에서 실행되는 프로세스
- 컨테이너 이미지를 기반으로 생성되며 호스트 시스템의 리소스를 공유
- 도커는 컨테이너를 사용하여 애플리케이션을 배포하고 실행한다.