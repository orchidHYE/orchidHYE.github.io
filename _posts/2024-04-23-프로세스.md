---
layout: post
title: "[운영체제] 프로세스"
date: 2024-04-23 22:34 +0900
categories:
  - CS
  - OS
tags: 
math: true
---
## 프로세스
![](https://i.imgur.com/crYxXMo.jpeg)
- 실행중인 프로그램
- 실행되기 전까지는, 보조기억장치에 저장되어 있는 데이터일 뿐

## 프로세스 종류
#### 포그라운드 프로세스 (foreground process)
- 사용자가 볼 수 있는 공간에서 실행되는 프로세스
- 웹 브라우저, 메모장, 워드 등이 해당
#### 백그라운드 프로세스 (background process)
- 사용자가 볼 수 없는 공간에서 실행되는 프로세스
- 백그라운드 프로세스는
	- 사용자와 직접 상호작용이 가능한 프로세스와
	- 사용자와 상호작용하지 않고 그저 정해진 일만 수행하는 프로세스로 나뉜다. 
		- 데몬 (daemon), 서비스(service)
			- 윈도우 운영체제의 경우 작업관리자 - 서비스탭에서 확인 가능

## 프로세스 제어 블록
>###### 모든 프로세스는 실행을 위해 CPU를 필요로 하지만 CPU는 한정적이다.
>![](https://i.imgur.com/shMkjGL.jpeg)
>- 프로세스들은 돌아가며 한정된 시간만큼만 CPU 이용
>- 자신의 차례에 정해진 시간만큼 CPU 이용
>- 타이머 인터럽트가 발생하면 차례 양보 (CPU 스케줄링)
<br/>

- 빠르게 번갈아 수행되는 프로세스를 운영체제가 관리하는데, 이를 관리하기 위해 사용되는 자료구조가 **프로세스 제어 블록(PCB)**이다.
- PCB는 프로세스 생성시 커널 영역에 생성되고 프로세스 종료시 폐기된다.

> ###### PCB에 담기는 대표적인 정보
>- 프로세스 ID (=PID)
>- 레지스터 값
>- 프로세스 상태
>- CPU 스케줄링 정보
>- 메모리 정보
>- 사용한 파일과 입출력장치 정보 (운영치제마다 차이 있음)
>###### 운영체제는 커널 영역에 저장된 PCB의 정보를 기반으로 프로세스를 관리한다.<br/>
`PCB에 레지스터 값이 담기는 이유: 프로세스 실행 중 타이머 인터럽트 발생으로 다른 프로세스가 CPU를 점유하는 상황이 온다. 해당 프로세스는 중단되고 인터럽트가 발생한 프로세스의 실행이 끝나면 실행이 재개된다. 이때, 프로그램 카운터, 스틱 포인터 등 모든 레지스터 값을 가지고 있어야만 실행이 원활히 재개되기 때문에, 레지스터 값을 PCB에 담는다.`<br/><br/>
`간단히 정리하면, 자신의 실행 차례가 오면 이전까지 사용했던 레지스터의 중간 값들을 모두 복원 후 실행을 재개하기 때문이다.`

<br/>

## 문맥 교환 (context switch)
###### 한 프로세스에서 다른 츠로세스로 실행순서가 넘어가면 어떤 작업이 이루어져야할까?

- 기존에 실행되던 프로세스는 지금까지의 중간 정보를 백업
- 프로그램 카운터 등 각종 레지스터 값, 메모리 정보, 열었던 파일, 사용한 입출력 등
- 이러한 중간 정보 == 문맥 (context)
- 다음 차례가 왔을 때 실행을 재개하기 위한 정보
- “실행 문맥을 백업해두면 언제든 해당 프로세스의 실행을 재개할 수 있다.”
![](https://i.imgur.com/WtdKrji.jpeg)

###### 프로세스가 커널 영역이 아닌, 사용자 영역에는 어떠한 정보가 저장될까
![](https://i.imgur.com/AWxPNrk.jpeg)

- 크게 코드 영역 (=텍스트 영역), 데이터 영역, 힙 영역, 스택 영역
#### 코드 영역 
- 텍스트 영역이라고도 함
- 실행할 수 있는 코드, **기계어로 이루어진 명령어** 저장
- 데이터가 아닌 CPU가 실행할 명령어가 담기기에 쓰기가 금지된 영역 (read-only)

#### 데이터 영역
- 잠깐 썼다가 없앨 데이터다 아닌 프로그램이 실행되는 동안 유지할 데이터 저장 (예를들어 전역 변수)

`코드 영역과 데이터 영역은 크기가 변하지 않고 고정되어있다. 이를 정적 할당 영역이라고 한다.`

#### 힙 영역
- 프로그램을 만드는 사용자, 즉 프로그래머가 직접 할당할 수 있는 저장공간

`힙 영역에 할당한 메모리는 언젠가 반드시 반환하는 과정을 거쳐야한다. 몇몇의 프로그래밍 언어는 이를 자동으로 해주는 가비지 컬렉션이 존재하지만 C언어는 이런 가비지 컬렉션이 존재하지 않는다. 사용한 힙 영역의 메모리 반환 과정을 거치지 않게 되면 메모리 누수가 발생한다.`

#### 스택 영역
- 데이터가 일시적으로 저장되는 공간
- 잠깐 쓰다가 말 값들이 저장되는 공간 (예를들어 매개 변수, 지역 변수)

###### 힙 영역과 스택 영역은 `동적 할당 영역`이다.


![](https://i.imgur.com/boKtaaa.jpeg)


- 일반적으로 힙 영역은 낮은 주소 → 높은 주소로 할당
- 일반적으로 스택 영역은 높은 주소 → 낮은 주소로 할당

`* 힙 영역과 스택 영역이 맞물려있다면 충돌이 일어날 수 있기 때문에 반대 반향에 주소를 할당한다.`
